(function(a){"function"===typeof define&&define.amd?define(["jquery","./grid.base","./jquery.fmatter","./grid.common","./jsonxml"],a):"object"===typeof exports?a(require("jquery")):a(jQuery)})(function(a){var v=a.jgrid,D=v.jqID,B=a.fn.jqGrid,K=B.getGuiStyles,U=v.mergeCssClasses,S=v.hasOneFromClasses,ja=v.feedback,ka=v.fullBoolFeedback,N=v.builderFmButon,ca=function(a,v,e){!0===v[0]&&(e="<span class='"+U("fm-button-icon",e,v[2])+"'></span>","right"===v[1]?a.addClass("fm-button-icon-right").append(e):
a.addClass("fm-button-icon-left").prepend(e))},P=function(a){return K.call(this,"states."+a)},da=function(a){return"&nbsp;"===a||"&#160;"===a||1===a.length&&160===a.charCodeAt(0)};v.extend({searchGrid:function(n){return this.each(function(){function R(b){q("beforeShow",b)&&(a(r).data("onClose",d.onClose),v.viewModal.call(e,r,{gbox:z,jqm:d.jqModal,overlay:d.overlay,modal:d.modal,overlayClass:d.overlayClass,toTop:d.toTop,onHide:function(a){a.w.remove();a.o&&a.o.remove()}}),q("afterShow",b))}var e=this,
m=a(e),l=e.p;if(e.grid&&null!=l){var d=a.extend(!0,{drag:!0,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",loadDefaults:!0,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,afterRedraw:null,afterChange:null,closeAfterSearch:!1,closeAfterReset:!1,closeOnEscape:!1,searchOnEnter:!1,multipleSearch:!1,multipleGroup:!1,top:0,left:0,removemodal:!0,resize:!0,width:450,height:"auto",dataheight:"auto",showQuery:!1,errorcheck:!0,sopt:null,stringResult:void 0,
onClose:null,onSearch:null,onReset:null,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:!1,layer:null,operands:{eq:"=",ne:"<>",lt:"<",le:"<=",gt:">",ge:">=",bw:"LIKE",bn:"NOT LIKE","in":"IN",ni:"NOT IN",ew:"LIKE",en:"NOT LIKE",cn:"LIKE",nc:"NOT LIKE",nu:"IS NULL",nn:"IS NOT NULL"}},B.getGridRes.call(m,"search"),v.search||{},l.searching||{},n||{}),c="fbox_"+l.id,g=d.commonIconClass,k={themodal:"searchmod"+c,modalhead:"searchhd"+c,modalcontent:"searchcnt"+c,resizeAlso:c},
r="#"+D(k.themodal),z=l.gBox,f=l.gView,p=a.each,t=l.postData[d.sFilter],q=function(){var b=a.makeArray(arguments);b.unshift("Search");b.unshift("Filter");b.unshift(d);return ja.apply(e,b)},A=function(){v.hideModal(r,{gb:z,jqm:d.jqModal,onClose:d.onClose,removemodal:d.removemodal})};"string"===typeof t&&(t=""!==a.trim(t)?a.parseJSON(t):void 0);a(r).remove();if(void 0!==a(r)[0])R(a("#fbox_"+l.idSel));else{var G=a("<div><div id='"+c+"' class='"+K.call(e,"dialog.body","searchFilter")+"' style='overflow:auto'></div></div>").insertBefore(f);
"rtl"===l.direction&&G.attr("dir","rtl");var H="",b="",y,J=!1,w,C=-1,x=a.extend([],l.colModel);w=N.call(e,c+"_search",d.Find,U(g,d.findDialogIcon),"right");var F=N.call(e,c+"_reset",d.Reset,U(g,d.resetDialogIcon),"left");d.showQuery&&(H=N.call(e,c+"_query","Query",U(g,d.queryDialogIcon),"left")+"&#160;");d.searchForAdditionalProperties&&p(l.additionalProperties,function(){var a="string"===typeof this?{name:this}:this;a.label||(a.label=a.name);a.isAddProp=!0;x.push(a)});d.columns.length?(x=d.columns,
C=0,y=x[0].index||x[0].name):p(x,function(a,b){b.label||(b.label=b.isAddProp?b.name:l.colNames[a]);if(!J){var d=void 0===b.search?!0:b.search,c=!0===b.hidden;if(b.searchoptions&&!0===b.searchoptions.searchhidden&&d||d&&!c)J=!0,y=b.index||b.name,C=a}});if(!t&&y||!1===d.multipleSearch)g="eq",0<=C&&x[C].searchoptions&&x[C].searchoptions.sopt?g=x[C].searchoptions.sopt[0]:d.sopt&&d.sopt.length&&(g=d.sopt[0]),t={groupOp:"AND",rules:[{field:y,op:g,data:""}]};J=!1;d.tmplNames&&d.tmplNames.length&&(J=!0,b=
d.tmplLabel,b+="<select class='ui-template'>",b+="<option value='default'>Default</option>",p(d.tmplNames,function(a,d){b+="<option value='"+a+"'>"+d+"</option>"}),b+="</select>");w="<div class='"+K.call(e,"dialog.footer")+"'><table class='EditTable' style='border:0px none;margin-top:5px' id='"+c+"_2'><tbody><tr><td colspan='2'><hr class='"+K.call(e,"dialog.hr")+"' style='margin:1px'/></td></tr><tr><td class='EditButton EditButton-"+l.direction+"'  style='float:"+("rtl"===l.direction?"right":"left")+
";'>"+F+b+"</td><td class='EditButton EditButton-"+l.direction+"'>"+H+w+"</td></tr></tbody></table></div>";c=D(c);d.gbox=z;d.height="auto";c="#"+c;a(c).jqFilter({columns:x,filter:d.loadDefaults?t:null,showQuery:d.showQuery,errorcheck:d.errorcheck,sopt:d.sopt,groupButton:d.multipleGroup,ruleButtons:d.multipleSearch,afterRedraw:d.afterRedraw,ops:d.odata,cops:l.customSortOperations,operands:d.operands,ajaxSelectOptions:l.ajaxSelectOptions,groupOps:d.groupOps,onChange:function(b){this.p.showQuery&&a(".query",
this).html(this.toUserFriendlyString());ka.call(e,d.afterChange,"jqGridFilterAfterChange",a(c),d,b)},direction:l.direction,id:l.id});G.append(w);J&&d.tmplFilters&&d.tmplFilters.length&&a(".ui-template",G).bind("change",function(){var b=a(this).val();"default"===b?a(c).jqFilter("addFilter",t):a(c).jqFilter("addFilter",d.tmplFilters[parseInt(b,10)]);return!1});!0===d.multipleGroup&&(d.multipleSearch=!0);q("onInitialize",a(c));d.layer?v.createModal.call(e,k,G,d,f,a(z)[0],"#"+D(d.layer),{position:"relative"}):
v.createModal.call(e,k,G,d,f,a(z)[0]);(d.searchOnEnter||d.closeOnEscape)&&a(r).keydown(function(b){var f=a(b.target);if(!(!d.searchOnEnter||13!==b.which||f.hasClass("add-group")||f.hasClass("add-rule")||f.hasClass("delete-group")||f.hasClass("delete-rule")||f.hasClass("fm-button")&&f.is("[id$=_query]")))return a(c+"_search").click(),!1;if(d.closeOnEscape&&27===b.which)return a("#"+D(k.modalhead)).find(".ui-jqdialog-titlebar-close").click(),!1});H&&a(c+"_query").bind("click",function(){a(".queryresult",
G).toggle();return!1});void 0===d.stringResult&&(d.stringResult=d.multipleSearch);a(c+"_search").bind("click",function(){var b={},f="",k,q=a(c);k=q.find(".input-elm");k.filter(":focus")&&(k=k.filter(":focus"));k.change();k=q.jqFilter("filterData");if(d.errorcheck&&(q[0].hideError(),d.showQuery||q.jqFilter("toSQLString"),q[0].p.error))return q[0].showError(),!1;if(d.stringResult||"local"===l.datatype){try{f=window.JSON&&window.JSON.stringify?JSON.stringify(k):xmlJsonClass.toJson(k,"","",!1)}catch(x){}"string"===
typeof f&&(b[d.sFilter]=f,p([d.sField,d.sValue,d.sOper],function(){b[this]=""}))}else d.multipleSearch?(b[d.sFilter]=k,p([d.sField,d.sValue,d.sOper],function(){b[this]=""})):(b[d.sField]=k.rules[0].field,b[d.sValue]=k.rules[0].data,b[d.sOper]=k.rules[0].op,b[d.sFilter]="");l.search=!0;a.extend(l.postData,b);ka.call(e,d.onSearch,"jqGridFilterSearch",l.filters)&&m.trigger("reloadGrid",[a.extend({page:1},d.reloadGridSearchOptions||{})]);d.closeAfterSearch&&A();return!1});a(c+"_reset").bind("click",function(){var b=
{},f=a(c);l.search=!1;l.resetsearch=!0;!1===d.multipleSearch?b[d.sField]=b[d.sValue]=b[d.sOper]="":b[d.sFilter]="";f[0].resetFilter();J&&a(".ui-template",G).val("default");a.extend(l.postData,b);ka.call(e,d.onReset,"jqGridFilterReset")&&m.trigger("reloadGrid",[a.extend({page:1},d.reloadGridResetOptions||{})]);d.closeAfterReset&&A();return!1});R(a(c));var u=P.call(e,"hover");a(".fm-button:not(."+P.call(e,"disabled").split(" ").join(".")+")",G).hover(function(){a(this).addClass(u)},function(){a(this).removeClass(u)})}}})},
editGridRow:function(n,R){return this.each(function(){function e(){a(C+" > tbody > tr > td .FormElement").each(function(){var M=a(".customelement",this),d=this.name;if(M.length){if(d=M.attr("name"),M=ea[d],void 0!==M&&(M=O[M],M=M.editoptions||{},a.isFunction(M.custom_value))){try{if(h[d]=M.custom_value.call(p,a("#"+D(d),C),"get"),void 0===h[d])throw"e1";}catch(f){"e1"===f?v.info_dialog.call(p,fa,"function 'custom_value' "+b.msg.novalue,b.bClose):v.info_dialog.call(p,fa,f.message,b.bClose)}return!0}}else switch(M=
a(this)[0].type,M){case "checkbox":h[d]=a(this).is(":checked")?a(this).val():a(this).data("offval");break;case "select-one":h[d]=a("option:selected",this).val();break;case "select-multiple":h[d]=a(this).val();h[d]=h[d]?h[d].join(","):"";a("option:selected",this).each(function(b,d){a(d).text()});break;case "date":h[d]=a(this).val();3===String(h[d]).split("-").length&&(M=ea[d],void 0!==M&&(M=O[M],M=M.formatoptions||{},M=M.newformat||G.call(t,"formatter.date.newformat"),h[d]=v.parseDate.call(t[0],"Y-m-d",
h[d],M)));break;default:void 0!==M&&0>a.inArray(M,b.skipPostTypes)&&(h[d]=a(this).val())}});return!0}function m(d,f,c){var E=0,e=[],h=!1,k="",l;for(l=1;l<=c;l++)k+="<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>";"_empty"!==d&&(h=B.getInd.call(t,d));a(O).each(function(l){var x=this.name,g,n,m,t,r;g=this.editable;var w=!1,I=!1;r="_empty"===d?"addForm":"editForm";a.isFunction(g)&&(g=g.call(p,{rowid:d,iCol:l,iRow:h,cmName:x,cm:this,mode:r}));t=(this.editrules&&!0===this.editrules.edithidden?
0:!0===this.hidden||"hidden"===g)?"style='display:none'":"";switch(String(g).toLowerCase()){case "hidden":g=!0;break;case "disabled":w=g=!0;break;case "readonly":I=g=!0}if("cb"!==x&&"subgrid"!==x&&!0===g&&"rn"!==x){if(!1===h)m="";else{g=a(p.rows[h].cells[l]);try{m=a.unformat.call(p,g,{rowId:d,colModel:this},l)}catch(X){m=this.edittype&&"textarea"===this.edittype?g.text():g.html()}da(m)&&(m="")}g=a.extend({},this.editoptions||{},{id:x,name:x,rowId:d,mode:r,cm:this,iCol:l});var u=a.extend({},{elmprefix:"",
elmsuffix:"",rowabove:!1,rowcontent:""},this.formoptions||{}),F=parseInt(u.rowpos,10)||E+1,B=parseInt(2*(parseInt(u.colpos,10)||1),10);"_empty"===d&&g.defaultValue&&(m=a.isFunction(g.defaultValue)?g.defaultValue.call(p):g.defaultValue);this.edittype||(this.edittype="text");q.autoEncodeOnEdit&&(m=v.oldDecodePostedData(m));r=v.createEl.call(p,this.edittype,g,m,!1,a.extend({},v.ajaxOptions,q.ajaxSelectOptions||{}));if(b.checkOnSubmit||b.checkOnUpdate)b._savedData[x]=m;a(r).addClass("FormElement");-1<
a.inArray(this.edittype,["text","textarea","checkbox","password","select"])&&a(r).addClass(K.call(p,"dialog.dataField"));n=a(f).find("tr[data-rowpos="+F+"]");if(u.rowabove){var z=a("<tr><td class='contentinfo' colspan='"+2*c+"'>"+u.rowcontent+"</td></tr>");a(f).append(z);z[0].rp=F}0===n.length&&(n=a("<tr "+t+" data-rowpos='"+F+"'></tr>").addClass("FormData").attr("id","tr_"+x),a(n).append(k),a(f).append(n),n[0].rp=F);t=a("td:eq("+(B-2)+")",n[0]);n=a("td:eq("+(B-1)+")",n[0]);t.html(void 0===u.label?
q.colNames[l]:u.label||"&#160;");n[da(n.html())?"html":"append"](u.elmprefix).append(r).append(u.elmsuffix);w?(t.addClass(T),n.addClass(T),a(r).prop("readonly",!0),a(r).prop("disabled",!0)):I&&a(r).prop("readonly",!0);"custom"===this.edittype&&a.isFunction(g.custom_value)&&g.custom_value.call(p,a("#"+D(x),y),"set",m);v.bindEv.call(p,r,g);e[E]=l;E++}});0<E&&(l=a("<tr class='FormData' style='display:none'><td class='CaptionTD'>&#160;</td><td colspan='"+(2*c-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+
A+"_id' value='"+d+"'/></td></tr>"),l[0].rp=E+999,a(f).append(l),b.checkOnSubmit||b.checkOnUpdate)&&(b._savedData[A+"_id"]=d);return e}function l(d,f){var c,E=0,e,h,g,k;if(b.checkOnSubmit||b.checkOnUpdate)b._savedData={},b._savedData[A+"_id"]=d;var l=q.colModel;if("_empty"===d)a(l).each(function(){c=this.name;h=a.extend({},this.editoptions||{});(e=a("#"+D(c),f))&&e.length&&null!==e[0]&&(g="","custom"===this.edittype&&a.isFunction(h.custom_value)?h.custom_value.call(p,e,"set",g):h.defaultValue?(g=
a.isFunction(h.defaultValue)?h.defaultValue.call(p):h.defaultValue,"checkbox"===e[0].type?(k=g.toLowerCase(),0>k.search(/(false|f|0|no|n|off|undefined)/i)&&""!==k?(e[0].checked=!0,e[0].defaultChecked=!0,e[0].value=g):(e[0].checked=!1,e[0].defaultChecked=!1)):e.val(g)):"checkbox"===e[0].type?(e[0].checked=!1,e[0].defaultChecked=!1,g=a(e).data("offval")):e[0].type&&"select"===e[0].type.substr(0,6)?e[0].selectedIndex=0:e.val(g),!0===b.checkOnSubmit||b.checkOnUpdate)&&(b._savedData[c]=g)}),a("#id_g",
f).val(d);else{var x=B.getInd.call(t,d,!0);x&&(a(x.cells).filter("td[role=gridcell]").each(function(e){var h;c=l[e].name;if("cb"!==c&&"subgrid"!==c&&"rn"!==c&&!0===l[e].editable){try{h=a.unformat.call(p,a(this),{rowId:d,colModel:l[e]},e)}catch(g){h="textarea"===l[e].edittype?a(this).text():a(this).html()}q.autoEncodeOnEdit&&(h=v.oldDecodePostedData(h));if(!0===b.checkOnSubmit||b.checkOnUpdate)b._savedData[c]=h;c="#"+D(c);switch(l[e].edittype){case "password":case "text":case "button":case "image":case "textarea":da(h)&&
(h="");a(c,f).val(h);break;case "select":var k=h.split(","),k=a.map(k,function(b){return a.trim(b)});a(c+" option",f).each(function(){var b=a(this),d=a.trim(b.val()),b=a.trim(b.text());l[e].editoptions.multiple||a.trim(h)!==b&&k[0]!==b&&k[0]!==d?l[e].editoptions.multiple?-1<a.inArray(b,k)||-1<a.inArray(d,k)?this.selected=!0:this.selected=!1:this.selected=!1:this.selected=!0});break;case "checkbox":h=String(h);l[e].editoptions&&l[e].editoptions.value?h=l[e].editoptions.value.split(":")[0]===h:(h=h.toLowerCase(),
h=0>h.search(/(false|f|0|no|n|off|undefined)/i)&&""!==h);a(c,f).prop({checked:h,defaultChecked:h});break;case "custom":try{if(l[e].editoptions&&a.isFunction(l[e].editoptions.custom_value))l[e].editoptions.custom_value.call(p,a(c,f),"set",h);else throw"e1";}catch(g){"e1"===g?v.info_dialog.call(p,fa,"function 'custom_value' "+b.msg.nodefined,b.bClose):v.info_dialog.call(p,fa,g.message,b.bClose)}}E++}}),0<E&&a("#id_g",C).val(d))}}function d(){var d=b.url||q.editurl;a.each(O,function(b,e){var c=e.name,
f=h[c];"date"!==e.formatter||null!=e.formatoptions&&!0===e.formatoptions.sendFormatted||(h[c]=a.unformat.date.call(p,f,e));"clientArray"!==d&&e.editoptions&&!0===e.editoptions.NullIfEmpty&&h.hasOwnProperty(c)&&""===f&&(h[c]="null")})}function c(){var e=[!0,"",""],c=e,f={},g=q.prmNames,k,m,r,w,u,I,F=B.getInd.call(t,n),X=!1===F?null:p.rows[F];(I=t.triggerHandler("jqGridAddEditBeforeCheckValues",[a(y),E]))&&"object"===typeof I&&(h=I);F=!1===F?-1:F;a.isFunction(b.beforeCheckValues)&&(I=b.beforeCheckValues.call(p,
h,a(y),E))&&"object"===typeof I&&(h=I);for(r in h)if(h.hasOwnProperty(r)){I=q.iColByName[r];c=v.checkValues.call(p,h[r],r,void 0,void 0,{oldValue:"_empty"===n?null:B.getCell.call(t,n,I),newValue:h[r],cmName:r,rowid:n,cm:O[I],iCol:I,iRow:F,tr:X,td:null==X?null:X.cells[I],mode:"_empty"===n?"addForm":"editForm"});if(null==c||!0===c)c=e;if(!1===c[0])break}d();if(c[0]){f=t.triggerHandler("jqGridAddEditClickSubmit",[b,h,E]);void 0===f&&a.isFunction(b.onclickSubmit)&&(f=b.onclickSubmit.call(p,b,h,E)||{});
c=t.triggerHandler("jqGridAddEditBeforeSubmit",[h,a(y),E]);if(null==c||!0===c)c=e;c[0]&&a.isFunction(b.beforeSubmit)&&(c=b.beforeSubmit.call(p,h,a(y),E),null==c||!0===c)&&(c=e)}if(c[0]&&!b.processing){b.processing=!0;a("#sData",x).addClass(Z);r=b.url||q.editurl;m=g.oper;k="clientArray"===r&&!1!==q.keyName?q.keyName:g.id;h[m]="_empty"===a.trim(h[A+"_id"])?g.addoper:g.editoper;h[m]!==g.addoper?h[k]=h[A+"_id"]:void 0===h[k]&&(h[k]=h[A+"_id"]);delete h[A+"_id"];h=a.extend(h,b.editData,f);if(!0===q.treeGrid)for(u in h[m]===
g.addoper&&(w=q.selrow,h["adjacency"===q.treeGridModel?q.treeReader.parent_id_field:"parent_id"]=w),q.treeReader)q.treeReader.hasOwnProperty(u)&&(f=q.treeReader[u],!h.hasOwnProperty(f)||h[m]===g.addoper&&"parent_id_field"===u||delete h[f]);h[k]=v.stripPref(q.idPrefix,h[k]);q.autoEncodeOnEdit&&a.each(h,function(b,c){a.isFunction(c)||(h[b]=v.oldEncodePostedData(c))});u=a.extend({url:a.isFunction(r)?r.call(p,h[k],E,h,b):r,type:a.isFunction(b.mtype)?b.mtype.call(p,E,b,h[k],h):b.mtype,data:v.serializeFeedback.call(p,
a.isFunction(b.serializeEditData)?b.serializeEditData:q.serializeEditData,"jqGridAddEditSerializeEditData",h),complete:function(d,f){a("#sData",x).removeClass(Z);h[k]=a("#id_g",C).val();if(300<=d.status&&304!==d.status||0===d.status&&4===d.readyState)c[0]=!1,c[1]=t.triggerHandler("jqGridAddEditErrorTextFormat",[d,E]),a.isFunction(b.errorTextFormat)?c[1]=b.errorTextFormat.call(p,d,E):c[1]=f+" Status: '"+d.statusText+"'. Error code: "+d.status;else{c=t.triggerHandler("jqGridAddEditAfterSubmit",[d,h,
E]);if(null==c||!0===c)c=e;c[0]&&a.isFunction(b.afterSubmit)&&(c=b.afterSubmit.call(p,d,h,E),null==c||!0===c)&&(c=e)}if(!1===c[0])a("#FormError>td",C).html(c[1]),a("#FormError",C).show();else{q.autoEncodeOnEdit&&a.each(h,function(a,b){h[a]=v.oldDecodePostedData(b)});var n=[a.extend({},b.reloadGridOptions||{})];h[m]===g.addoper?(c[2]||(c[2]=v.randId()),null==h[k]||"_empty"===h[k]||h[m]===g.addoper?h[k]=c[2]:c[2]=h[k],b.reloadAfterSubmit?t.trigger("reloadGrid",n):!0===q.treeGrid?B.addChildNode.call(t,
c[2],w,h):B.addRowData.call(t,c[2],h,b.addedrow),b.closeAfterAdd?(!0!==q.treeGrid&&H.call(t,c[2]),W()):b.clearAfterAdd&&l("_empty",y)):(b.reloadAfterSubmit?(t.trigger("reloadGrid",n),b.closeAfterEdit||setTimeout(function(){H.call(t,h[k])},1E3)):!0===q.treeGrid?B.setTreeRow.call(t,h[k],h):B.setRowData.call(t,h[k],h),b.closeAfterEdit&&W());if(a.isFunction(b.afterComplete)){var r=d;setTimeout(function(){t.triggerHandler("jqGridAddEditAfterComplete",[r,h,a(y),E]);b.afterComplete.call(p,r,h,a(y),E);r=
null},50)}if(b.checkOnSubmit||b.checkOnUpdate)if(a(y).data("disabled",!1),"_empty"!==b._savedData[A+"_id"])for(var u in b._savedData)b._savedData.hasOwnProperty(u)&&h[u]&&(b._savedData[u]=h[u])}b.processing=!1;try{a(":input:visible",y)[0].focus()}catch(I){}}},v.ajaxOptions,b.ajaxEditOptions);u.url||b.useDataProxy||(a.isFunction(q.dataProxy)?b.useDataProxy=!0:(c[0]=!1,c[1]+=" "+v.errors.nourl));c[0]&&(b.useDataProxy?(f=q.dataProxy.call(p,u,"set_"+A),void 0===f&&(f=[!0,""]),!1===f[0]?(c[0]=!1,c[1]=
f[1]||"Error deleting the selected row!"):(u.data.oper===g.addoper&&b.closeAfterAdd&&W(),u.data.oper===g.editoper&&b.closeAfterEdit&&W())):"clientArray"===u.url?(b.reloadAfterSubmit=!1,h=u.data,u.complete({status:200,statusText:""},"")):a.ajax(u))}!1===c[0]&&(a("#FormError>td",C).html(c[1]),a("#FormError",C).show())}function g(a,b){var c=!1,d;for(d in a)if(a.hasOwnProperty(d)&&String(a[d])!==String(b[d])){c=!0;break}return c}function k(){var c=!0;a("#FormError",C).hide();b.checkOnUpdate&&(h={},e(),
aa=g(h,b._savedData))&&(a(y).data("disabled",!0),a(".confirm",u).show(),c=!1);return c}function r(){var b=v.detectRowEditing.call(p,n);if(null!=b)if("inlineEditing"===b.mode)B.restoreRow.call(t,n);else{var b=b.savedRow,c=p.rows[b.id];B.restoreCell.call(t,b.id,b.ic);a(c.cells[b.ic]).removeClass("edit-cell "+oa);a(c).addClass(oa).attr({"aria-selected":"true",tabindex:"0"})}}function z(b,c){var d=c[1].length-1;0===b?a("#pData",x).addClass(T):void 0!==c[1][b-1]&&S(a("#"+D(c[1][b-1])),T)?a("#pData",x).addClass(T):
a("#pData",x).removeClass(T);b===d?a("#nData",x).addClass(T):void 0!==c[1][b+1]&&S(a("#"+D(c[1][b+1])),T)?a("#nData",x).addClass(T):a("#nData",x).removeClass(T)}function f(){var b=B.getDataIDs.call(t),c=a("#id_g",C).val();return[a.inArray(c,b),b]}var p=this,t=a(p),q=p.p;if(p.grid&&null!=q&&n){var A=q.id,G=B.getGridRes,H=B.setSelection,b=a.extend(!0,{top:0,left:0,width:300,datawidth:"auto",height:"auto",dataheight:"auto",drag:!0,resize:!0,url:null,mtype:"POST",clearAfterAdd:!0,closeAfterEdit:!1,reloadAfterSubmit:!0,
onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},closeOnEscape:!1,addedrow:"first",topinfo:"",bottominfo:"",savekey:[!1,13],navkeys:[!1,38,40],checkOnSubmit:!1,checkOnUpdate:!1,_savedData:{},processing:!1,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:!0,overlayClass:K.call(this,"overlay"),removemodal:!0,skipPostTypes:["image",
"file"]},G.call(t,"edit"),v.edit,q.formEditing||{},R||{}),y="FrmGrid_"+A,J=y,w="TblGrid_"+A,C="#"+D(w),x=C+"_2",F={themodal:"editmod"+A,modalhead:"edithd"+A,modalcontent:"editcnt"+A,resizeAlso:y},u="#"+D(F.themodal),L=q.gBox,O=q.colModel,ea=q.iColByName,Q=1,V=0,h,aa,E,X=b.commonIconClass,W=function(){v.hideModal(u,{gb:L,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal})},fa=G.call(t,"errors.errcap"),Y=function(){var c=a.makeArray(arguments);c.unshift("");c.unshift("AddEdit");c.unshift(b);
return ja.apply(p,c)},pa=P.call(p,"hover"),T=P.call(p,"disabled"),oa=P.call(p,"select"),Z=P.call(p,"active"),I=P.call(p,"error");a(u).remove();y="#"+D(y);"new"===n?(n="_empty",E="add",b.caption=b.addCaption):(b.caption=b.editCaption,E="edit");var ia=!0;!b.checkOnUpdate||!0!==b.jqModal&&void 0!==b.jqModal||b.modal||(ia=!1);var ga=isNaN(b.dataheight)?b.dataheight:b.dataheight+"px",ba=isNaN(b.datawidth)?b.datawidth:b.datawidth+"px",J=a("<form name='FormPost' id='"+J+"' class='FormGrid' onSubmit='return false;' style='width:"+
ba+";overflow:auto;position:relative;height:"+ga+";'></form>").data("disabled",!1),ha=a("<table id='"+w+"' class='EditTable'><tbody></tbody></table>");a(O).each(function(){var a=this.formoptions;Q=Math.max(Q,a?a.colpos||0:0);V=Math.max(V,a?a.rowpos||0:0)});a(J).append(ha);I=a("<tr id='FormError' style='display:none'><td class='"+I+"' colspan='"+2*Q+"'>&#160;</td></tr>");I[0].rp=0;a(ha).append(I);I=a("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+2*Q+"'>"+(b.topinfo||"&#160;")+
"</td></tr>");I[0].rp=0;a(ha).append(I);if(Y("beforeInitData",J,E)){r();ga=(I="rtl"===q.direction?!0:!1)?"nData":"pData";ba=I?"pData":"nData";m(n,ha,Q);var ga=N.call(p,ga,"",U(X,b.prevIcon),"","left"),ba=N.call(p,ba,"",U(X,b.nextIcon),"","right"),la=N.call(p,"sData",b.bSubmit),ma=N.call(p,"cData",b.bCancel),w="<div class='"+K.call(p,"dialog.footer")+"'><table class='EditTable' id='"+w+"_2'><tbody><tr><td colspan='2'><hr class='"+K.call(p,"dialog.hr")+"' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton navButton-"+
q.direction+"'>"+(I?ba+ga:ga+ba)+"</td><td class='EditButton EditButton-"+q.direction+"'>"+la+"&#160;"+ma+"</td></tr>",w=w+("<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+(b.bottominfo||"&#160;")+"</td></tr>"),w=w+"</tbody></table></div>";if(0<V){var na=[];a.each(a(ha)[0].rows,function(a,b){na[a]=b});na.sort(function(a,b){return a.rp>b.rp?1:a.rp<b.rp?-1:0});a.each(na,function(b,c){a("tbody",ha).append(c)})}b.gbox=L;var qa=!1;!0===b.closeOnEscape&&(b.closeOnEscape=!1,
qa=!0);w=a("<div></div>").append(a("<div class='"+K.call(p,"dialog.body")+"'></div>").append(J)).append(w);v.createModal.call(p,F,w,b,q.gView,a(L)[0]);b.topinfo&&a(".tinfo",C).show();b.bottominfo&&a(".binfo",x).show();w=w=null;a(u).keydown(function(c){var d=(c.target.tagName||"").toUpperCase(),e,f;if(!0===a(y).data("disabled"))return!1;if(13===c.which&&"TEXTAREA"!==d){e=a(x).find(":focus");f=e.attr("id");if(0<e.length&&0<=a.inArray(f,["pData","nData","cData"]))return e.trigger("click"),!1;if(!0===
b.savekey[0]&&13===b.savekey[1])return a("#sData",x).trigger("click"),!1}if(!0===b.savekey[0]&&c.which===b.savekey[1]&&"TEXTAREA"!==d)return a("#sData",x).trigger("click"),!1;if(27===c.which){if(!k())return!1;qa&&W();return!1}if(!0===b.navkeys[0]){if("_empty"===a("#id_g",C).val())return!0;if(c.which===b.navkeys[1])return a("#pData",x).trigger("click"),!1;if(c.which===b.navkeys[2])return a("#nData",x).trigger("click"),!1}});b.checkOnUpdate&&(a("a.ui-jqdialog-titlebar-close span",u).removeClass("jqmClose"),
a("a.ui-jqdialog-titlebar-close",u).unbind("click").click(function(){if(!k())return!1;W();return!1}));ca(a("#sData",x),b.saveicon,X);ca(a("#cData",x),b.closeicon,X);if(b.checkOnSubmit||b.checkOnUpdate)la=N.call(p,"sNew",b.bYes),ba=N.call(p,"nNew",b.bNo),ma=N.call(p,"cNew",b.bExit),F=b.zIndex||999,F++,a("<div class='"+b.overlayClass+" jqgrid-overlay confirm' style='z-index:"+F+";display:none;'>&#160;</div><div class='"+K.call(p,"dialog.content","confirm ui-jqconfirm")+"' style='z-index:"+(F+1)+"'>"+
b.saveData+"<br/><br/>"+la+ba+ma+"</div>").insertAfter(y),a("#sNew",u).click(function(){c();a(y).data("disabled",!1);a(".confirm",u).hide();return!1}),a("#nNew",u).click(function(){a(".confirm",u).hide();a(y).data("disabled",!1);setTimeout(function(){a(":input:visible",y)[0].focus()},0);return!1}),a("#cNew",u).click(function(){a(".confirm",u).hide();a(y).data("disabled",!1);W();return!1});Y("onInitializeForm",a(y),E);"_empty"!==n&&b.viewPagerButtons?a("#pData,#nData",x).show():a("#pData,#nData",x).hide();
Y("beforeShowForm",a(y),E);a(u).data("onClose",b.onClose);v.viewModal.call(p,u,{gbox:L,jqm:b.jqModal,overlay:b.overlay,modal:b.modal,overlayClass:b.overlayClass,toTop:b.toTop,onHide:function(a){a.w.remove();a.o&&a.o.remove()}});ia||a("."+D(b.overlayClass)).click(function(){if(!k())return!1;W();return!1});a(".fm-button",u).hover(function(){a(this).addClass(pa)},function(){a(this).removeClass(pa)});a("#sData",x).click(function(){h={};a("#FormError",C).hide();e();"_empty"===h[A+"_id"]?c():!0===b.checkOnSubmit?
(aa=g(h,b._savedData))?(a(y).data("disabled",!0),a(".confirm",u).show()):c():c();return!1});a("#cData",x).click(function(){if(!k())return!1;W();return!1});a("#nData",x).click(function(){if(!k())return!1;a("#FormError",C).hide();var b=f();b[0]=parseInt(b[0],10);if(-1!==b[0]&&b[1][b[0]+1]){if(!Y("onclickPgButtons","next",a(y),b[1][b[0]]))return!1;l(b[1][b[0]+1],y);H.call(t,b[1][b[0]+1]);Y("afterclickPgButtons","next",a(y),b[1][b[0]+1]);z(b[0]+1,b)}return!1});a("#pData",x).click(function(){if(!k())return!1;
a("#FormError",C).hide();var b=f();if(-1!==b[0]&&b[1][b[0]-1]){if(!Y("onclickPgButtons","prev",a(y),b[1][b[0]])||S(a("#"+D(b[1][b[0]-1])),T))return!1;l(b[1][b[0]-1],y);H.call(t,b[1][b[0]-1]);Y("afterclickPgButtons","prev",a(y),b[1][b[0]-1]);z(b[0]-1,b)}return!1});Y("afterShowForm",a(y),E);ia=f();z(ia[0],ia)}}})},viewGridRow:function(n,R){return this.each(function(){function e(){!0!==f.closeOnEscape&&!0!==f.navkeys[0]||setTimeout(function(){a("#cData").focus()},0)}function m(b,c,d){var e,h,l,m=0,x,
p,n=[],q=B.getInd.call(k,b),u;u=K.call(g,"dialog.viewData","DataTD form-view-data");var t=K.call(g,"dialog.viewLabel","CaptionTD form-view-label"),w="<td class='"+t+"' width='"+f.labelswidth+"'>&#160;</td><td class='"+u+" ui-helper-reset'>&#160;</td>",F="",t="<td class='"+t+"'></td><td class='"+u+"'></td>",y=["integer","number","currency"],z=0,A=0,C,D,L;for(u=1;u<=d;u++)F+=1===u?w:t;a(J).each(function(){(h=this.editrules&&!0===this.editrules.edithidden?!1:!0===this.hidden?!0:!1)||"right"!==this.align||
(this.formatter&&-1!==a.inArray(this.formatter,y)?z=Math.max(z,parseInt(this.width,10)):A=Math.max(A,parseInt(this.width,10)))});C=0!==z?z:0!==A?A:0;a(J).each(function(b){e=this.name;D=!1;p=(h=this.editrules&&!0===this.editrules.edithidden?!1:!0===this.hidden?!0:!1)?"style='display:none'":"";L="boolean"!==typeof this.viewable?!0:this.viewable;if("cb"!==e&&"subgrid"!==e&&"rn"!==e&&L){x=!1===q?"":v.getDataFieldOfCell.call(g,g.rows[q],b).html();D="right"===this.align&&0!==C?!0:!1;var f=a.extend({},{rowabove:!1,
rowcontent:""},this.formoptions||{}),k=parseInt(f.rowpos,10)||m+1,E=parseInt(2*(parseInt(f.colpos,10)||1),10);if(f.rowabove){var u=a("<tr><td class='contentinfo' colspan='"+2*d+"'>"+f.rowcontent+"</td></tr>");a(c).append(u);u[0].rp=k}l=a(c).find("tr[data-rowpos="+k+"]");0===l.length&&(l=a("<tr "+p+" data-rowpos='"+k+"'></tr>").addClass("FormData").attr("id","trv_"+e),a(l).append(F),a(c).append(l),l[0].rp=k);f=void 0===f.label?r.colNames[b]:f.label;k=a("td:eq("+(E-1)+")",l[0]);a("td:eq("+(E-2)+")",
l[0]).html("<b>"+(f||"&nbsp;")+"</b>");k[da(k.html())?"html":"append"]("<span>"+(x||"&nbsp;")+"</span>").attr("id","v_"+e);D&&a("td:eq("+(E-1)+") span",l[0]).css({"text-align":"right",width:C+"px"});n[m]=b;m++}});0<m&&(b=a("<tr class='FormData' style='display:none'><td class='CaptionTD'>&#160;</td><td colspan='"+(2*d-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+b+"'/></td></tr>"),b[0].rp=m+99,a(c).append(b));return n}function l(b){var c,d,e=0,f=B.getInd.call(k,
b,!0),h;f&&(a("td",f).each(function(b){h=J[b];c=h.name;d=h.editrules&&!0===h.editrules.edithidden?!1:!0===h.hidden?!0:!1;"cb"!==c&&"subgrid"!==c&&"rn"!==c&&(c=D("v_"+c),a("#"+c+" span",t).html(v.getDataFieldOfCell.call(g,f,b).html()),d&&a("#"+c,t).parents("tr:first").hide(),e++)}),0<e&&a("#id_g",t).val(b))}function d(b,c){var d=c[1].length-1;0===b?a("#pData",q).addClass(L):void 0!==c[1][b-1]&&S(a("#"+D(c[1][b-1])),L)?a("#pData",q).addClass(L):a("#pData",q).removeClass(L);b===d?a("#nData",q).addClass(L):
void 0!==c[1][b+1]&&S(a("#"+D(c[1][b+1])),L)?a("#nData",q).addClass(L):a("#nData",q).removeClass(L)}function c(){var b=B.getDataIDs.call(k),c=a("#id_g",t).val();return[a.inArray(c,b),b]}var g=this,k=a(g),r=g.p;if(g.grid&&null!=r&&n){var z=r.id,f=a.extend(!0,{top:0,left:0,width:0,datawidth:"auto",height:"auto",dataheight:"auto",drag:!0,resize:!0,closeOnEscape:!1,labelswidth:"30%",navkeys:[!1,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:!0,removemodal:!0},B.getGridRes.call(k,
"view"),v.view||{},r.formViewing||{},R||{}),p="#ViewGrid_"+D(z),t="#ViewTbl_"+D(z),q=t+"_2",A="ViewGrid_"+z,G="ViewTbl_"+z,H=f.commonIconClass,z={themodal:"viewmod"+z,modalhead:"viewhd"+z,modalcontent:"viewcnt"+z,resizeAlso:A},b="#"+D(z.themodal),y=r.gBox,J=r.colModel,w=1,C=0,x=function(){var b=a.makeArray(arguments);b.unshift("");b.unshift("View");b.unshift(f);return ja.apply(g,b)},F=function(){v.hideModal(b,{gb:y,jqm:f.jqModal,onClose:f.onClose,removemodal:f.removemodal})},u=P.call(g,"hover"),L=
P.call(g,"disabled"),O=isNaN(f.dataheight)?f.dataheight:f.dataheight+"px",ea=isNaN(f.datawidth)?f.datawidth:f.datawidth+"px",A=a("<div class='"+K.call(g,"dialog.body")+"'><form name='FormPost' id='"+A+"' class='FormGrid' style='width:"+ea+";overflow:auto;position:relative;height:"+O+";'></form></div>"),O=A.children("form.FormGrid"),Q=a("<table id='"+G+"' class='EditTable'><tbody></tbody></table>");a(b).remove();a(J).each(function(){var a=this.formoptions;w=Math.max(w,a?a.colpos||0:0);C=Math.max(C,
a?a.rowpos||0:0)});O.append(Q);if(x("beforeInitData",O)){m(n,Q,w);var V=(O="rtl"===r.direction?!0:!1)?"pData":"nData",ea=N.call(g,O?"nData":"pData","",U(H,f.prevIcon),"","left"),V=N.call(g,V,"",U(H,f.nextIcon),"","right"),h=N.call(g,"cData",f.bClose);if(0<C){var aa=[];a.each(a(Q)[0].rows,function(a,b){aa[a]=b});aa.sort(function(a,b){return a.rp>b.rp?1:a.rp<b.rp?-1:0});a.each(aa,function(b,c){a("tbody",Q).append(c)})}f.gbox=y;G=a("<div></div>").append(A).append("<div class='"+K.call(g,"dialog.footer")+
"'><table border='0' class='EditTable' id='"+G+"_2'><tbody><tr id='Act_Buttons'><td class='navButton navButton-"+r.direction+"' width='"+(f.labelswidth||"auto")+"'>"+(O?V+ea:ea+V)+"</td><td class='EditButton EditButton-"+r.direction+"'>"+h+"</td></tr></tbody></table></div>");v.createModal.call(g,z,G,f,r.gView,a(r.gView)[0]);f.viewPagerButtons||a("#pData, #nData",q).hide();G=null;a(b).keydown(function(b){var c,d;if(!0===a(p).data("disabled"))return!1;if(13===b.which&&(c=a(q).find(":focus"),d=c.attr("id"),
0<c.length&&0<=a.inArray(d,["pData","nData","cData"])))return c.trigger("click"),!1;if(27===b.which)return f.closeOnEscape&&F(),!1;if(!0===f.navkeys[0]){if(b.which===f.navkeys[1])return a("#pData",q).trigger("click"),!1;if(b.which===f.navkeys[2])return a("#nData",q).trigger("click"),!1}});ca(a("#cData",q),f.closeicon,H);x("beforeShowForm",a(p));v.viewModal.call(g,b,{gbox:y,jqm:f.jqModal,overlay:f.overlay,toTop:f.toTop,modal:f.modal,onHide:function(a){a.w.remove();a.o&&a.o.remove()}});a(".fm-button:not(."+
L.split(" ").join(".")+")",q).hover(function(){a(this).addClass(u)},function(){a(this).removeClass(u)});e();a("#cData",q).click(function(){F();return!1});a("#nData",q).click(function(){a("#FormError",t).hide();var b=c();b[0]=parseInt(b[0],10);if(-1!==b[0]&&b[1][b[0]+1]){if(!x("onclickPgButtons","next",a(p),b[1][b[0]]))return!1;l(b[1][b[0]+1]);B.setSelection.call(k,b[1][b[0]+1]);x("afterclickPgButtons","next",a(p),b[1][b[0]+1]);d(b[0]+1,b)}e();return!1});a("#pData",q).click(function(){a("#FormError",
t).hide();var b=c();if(-1!==b[0]&&b[1][b[0]-1]){if(!x("onclickPgButtons","prev",a(p),b[1][b[0]]))return!1;l(b[1][b[0]-1]);B.setSelection.call(k,b[1][b[0]-1]);x("afterclickPgButtons","prev",a(p),b[1][b[0]-1]);d(b[0]-1,b)}e();return!1});H=c();d(H[0],H)}}})},delGridRow:function(n,R){return this.each(function(){var e=this,m=e.p,l=a(e);if(e.grid&&null!=m&&n){var d=m.id,c=a.extend(!0,{top:0,left:0,width:240,removemodal:!0,height:"auto",dataheight:"auto",datawidth:"auto",drag:!0,resize:!0,url:"",mtype:"POST",
reloadAfterSubmit:!0,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,closeOnEscape:!1,delData:{},onClose:null,ajaxDelOptions:{},processing:!1,serializeDelData:null,useDataProxy:!1},B.getGridRes.call(l,"del"),v.del||{},m.formDeleting||{},R||{}),g="DelTbl_"+d,k="#DelTbl_"+D(d),r,z,f,p,t={themodal:"delmod"+d,modalhead:"delhd"+d,modalcontent:"delcnt"+d,resizeAlso:g},q="#"+D(t.themodal),A=m.gBox,G=c.commonIconClass,H=function(){var b=a.makeArray(arguments);
b.unshift("");b.unshift("Delete");b.unshift(c);return ja.apply(e,b)},b=P.call(e,"hover"),y=P.call(e,"active"),J=P.call(e,"error");a.isArray(n)||(n=[String(n)]);if(void 0!==a(q)[0]){if(!H("beforeInitData",a(k)))return;a("#DelData>td",k).text(n.join()).data("rowids",n);a("#DelError",k).hide();!0===c.processing&&(c.processing=!1,a("#dData",k).removeClass(y));H("beforeShowForm",a(k));v.viewModal.call(e,q,{gbox:A,jqm:c.jqModal,jqM:!1,overlay:c.overlay,toTop:c.toTop,modal:c.modal})}else{var w=isNaN(c.dataheight)?
c.dataheight:c.dataheight+"px",C=isNaN(c.datawidth)?c.datawidth:c.datawidth+"px",w="<div class='"+K.call(e,"dialog.body")+"'><div id='"+g+"' class='formdata' style='width:"+C+";overflow:auto;position:relative;height:"+w+";'>",w=w+"<table class='DelTable'><tbody>"+("<tr id='DelError' style='display:none'><td class='"+J+"'></td></tr>"),w=w+("<tr id='DelData' style='display:none'><td >"+n.join()+"</td></tr>"),w=w+("<tr><td class='delmsg' style='white-space:pre;'>"+c.msg+"</td></tr>"),w=w+"</tbody></table></div></div>",
J=N.call(e,"dData",c.bSubmit),C=N.call(e,"eData",c.bCancel),w=w+("<div class='"+K.call(e,"dialog.footer")+"'><table class='EditTable' id='"+g+"_2'><tbody><tr><td><hr class='"+K.call(e,"dialog.hr")+"' style='margin:1px'/></td></tr><tr><td class='DelButton EditButton EditButton-"+m.direction+"'>"+J+"&#160;"+C+"</td></tr></tbody></table></div>");c.gbox=A;v.createModal.call(e,t,w,c,m.gView,a(m.gView)[0]);a("#DelData>td",k).data("rowids",n);if(!H("beforeInitData",a(w)))return;a(".fm-button",k+"_2").hover(function(){a(this).addClass(b)},
function(){a(this).removeClass(b)});ca(a("#dData",k+"_2"),c.delicon,G);ca(a("#eData",k+"_2"),c.cancelicon,G);a("#dData",k+"_2").click(function(){var b=[!0,""],g,n=a("#DelData>td",k),t=n.text(),w=n.data("rowids"),n={};a.isFunction(c.onclickSubmit)&&(n=c.onclickSubmit.call(e,c,t)||{});a.isFunction(c.beforeSubmit)&&(b=c.beforeSubmit.call(e,t)||b);if(b[0]&&!c.processing){c.processing=!0;f=m.prmNames;r=a.extend({},c.delData,n);p=f.oper;r[p]=f.deloper;z=f.id;t=w.slice();if(!t.length)return!1;for(g in t)t.hasOwnProperty(g)&&
(t[g]=v.stripPref(m.idPrefix,t[g]));r[z]=t.join();a(this).addClass(y);g=c.url||m.editurl;g=a.extend({url:a.isFunction(g)?g.call(e,r[z],r,c):g,type:c.mtype,data:a.isFunction(c.serializeDelData)?c.serializeDelData.call(e,r):r,complete:function(d,f){var g;a("#dData",k+"_2").removeClass(y);300<=d.status&&304!==d.status||0===d.status&&4===d.readyState?(b[0]=!1,a.isFunction(c.errorTextFormat)?b[1]=c.errorTextFormat.call(e,d):b[1]=f+" Status: '"+d.statusText+"'. Error code: "+d.status):a.isFunction(c.afterSubmit)&&
(b=c.afterSubmit.call(e,d,r)||[!0]);if(!1===b[0])a("#DelError>td",k).html(b[1]),a("#DelError",k).show();else{if(c.reloadAfterSubmit&&"local"!==m.datatype)l.trigger("reloadGrid",[a.extend({},c.reloadGridOptions||{})]);else if(!0===m.treeGrid)try{B.delTreeNode.call(l,w[0])}catch(h){}else for(w=w.slice(),g=0;g<w.length;g++)B.delRowData.call(l,w[g]);setTimeout(function(){H("afterComplete",d,t,a(k))},50)}c.processing=!1;b[0]&&v.hideModal(q,{gb:A,jqm:c.jqModal,onClose:c.onClose,removemodal:c.removemodal})}},
v.ajaxOptions,c.ajaxDelOptions);g.url||c.useDataProxy||(a.isFunction(m.dataProxy)?c.useDataProxy=!0:(b[0]=!1,b[1]+=" "+v.errors.nourl));b[0]&&(c.useDataProxy?(g=m.dataProxy.call(e,g,"del_"+d),void 0===g&&(g=[!0,""]),!1===g[0]?(b[0]=!1,b[1]=g[1]||"Error deleting the selected row!"):v.hideModal(q,{gb:A,jqm:c.jqModal,onClose:c.onClose,removemodal:c.removemodal})):"clientArray"===g.url?(r=g.data,g.complete({status:200,statusText:""},"")):a.ajax(g))}!1===b[0]&&(a("#DelError>td",k).html(b[1]),a("#DelError",
k).show());return!1});a("#eData",k+"_2").click(function(){v.hideModal(q,{gb:A,jqm:c.jqModal,onClose:c.onClose,removemodal:c.removemodal});return!1});H("beforeShowForm",a(k));v.viewModal.call(e,q,{gbox:A,jqm:c.jqModal,overlay:c.overlay,toTop:c.toTop,modal:c.modal})}H("afterShowForm",a(k));!0===c.closeOnEscape&&setTimeout(function(){a(".ui-jqdialog-titlebar-close","#"+D(t.modalhead)).attr("tabindex","-1").focus()},0)}})},navGrid:function(n,R,e,m,l,d,c){"object"===typeof n&&(c=d,d=l,l=m,m=e,e=R,R=n,
n=void 0);m=m||{};e=e||{};c=c||{};l=l||{};d=d||{};return this.each(function(){var g=this,k=g.p,r=a(g);if(g.grid&&null!=k&&!(g.nav&&0<a(n).find(".navtable").length)){var z=k.id,f=a.extend({edit:!0,add:!0,del:!0,search:!0,refresh:!0,refreshstate:"firstpage",view:!1,closeOnEscape:!0,beforeRefresh:null,afterRefresh:null,cloneToTop:!1,hideEmptyPagerParts:!0,alertwidth:200,alertheight:"auto",alerttop:null,removemodal:!0,alertleft:null,alertzIndex:null,iconsOverText:!1},B.getGridRes.call(r,"nav"),v.nav||
{},k.navOptions||{},R||{});f.position=f.position||("rtl"===k.direction?"right":"left");var p,t=k.idSel,q=k.gBox,A=f.commonIconClass,G={themodal:"alertmod_"+z,modalhead:"alerthd_"+z,modalcontent:"alertcnt_"+z},H=function(){return function(){var b=document.documentElement,c=window,d=1024,e=768,h=r.closest(".ui-jqgrid").offset();void 0===a("#"+D(G.themodal))[0]&&(f.alerttop||f.alertleft||(void 0!==c.innerWidth?(d=c.innerWidth,e=c.innerHeight):null!=b&&void 0!==b.clientWidth&&0!==b.clientWidth&&(d=b.clientWidth,
e=b.clientHeight),d=d/2-parseInt(f.alertwidth,10)/2-h.left,e=e/2-25-h.top),v.createModal.call(g,G,"<div class='"+K.call(g,"dialog.body")+"'><div>"+f.alerttext+"</div></div>",{gbox:q,jqModal:f.jqModal,drag:!0,resize:!0,caption:f.alertcap,top:null!=f.alerttop?f.alerttop:e,left:null!=f.alertleft?f.alertleft:d,width:f.alertwidth,height:f.alertheight,closeOnEscape:f.closeOnEscape,zIndex:f.alertzIndex,removemodal:f.removemodal},k.gView,a(q)[0],!1));v.viewModal.call(g,"#"+D(G.themodal),{gbox:q,toTop:f.alertToTop,
jqm:f.jqModal});var l=a("#"+D(G.modalhead)).find(".ui-jqdialog-titlebar-close");l.attr({tabindex:"0",href:"#",role:"button"});setTimeout(function(){l.focus()},50)}}(),b,y=function(b){if(13===b.which&&(b=a(this).find(".ui-pg-button").filter(":focus"),0<b.length)){var c=b[0].id,c=c.substr(0,0<a(this).closest(".ui-jqgrid-toppager").length?c.length-z.length-5:c.length-z.length-1)+"mod"+k.id,d=a(".ui-jqdialog").filter(":visible").map(function(){return this.id});if(0>a.inArray(c,d))return b.trigger("click"),
!1}},J=P.call(g,"hover"),w=P.call(g,"disabled"),C=K.call(g,"navButton","ui-pg-button");if(g.grid){g.modalAlert=H;void 0===n&&(k.pager?(n=k.pager,k.toppager&&(f.cloneToTop=!0)):k.toppager&&(n=k.toppager));var x=1,F,u,L,O,N,Q,V=["left","center","right"],h="<div class='"+K.call(g,"navButton","ui-pg-button "+P.call(g,"disabled"))+"'><span class='ui-separator'></span></div>",aa=function(){S(this,w)||a(this).addClass(J)},E=function(){a(this).removeClass(J)},X=function(){S(this,w)||(a.isFunction(f.addfunc)?
f.addfunc.call(g):B.editGridRow.call(r,"new",m));return!1},W=function(b,c,d){if(!S(this,w)){var e=k.selrow;e?a.isFunction(b)?b.call(g,e):B[c].call(r,e,d):H()}return!1},fa=function(){return W.call(this,f.editfunc,"editGridRow",e)},Y=function(){return W.call(this,f.viewfunc,"viewGridRow",c)},ca=function(){var b;S(this,w)||(k.multiselect?(b=k.selarrrow,0===b.length&&(b=null)):b=k.selrow,b?a.isFunction(f.delfunc)?f.delfunc.call(g,b):B.delGridRow.call(r,b,l):H());return!1},T=function(){S(this,w)||(a.isFunction(f.searchfunc)?
f.searchfunc.call(g,d):B.searchGrid.call(r,d));return!1},da=function(){if(!S(this,w)){a.isFunction(f.beforeRefresh)&&f.beforeRefresh.call(g);k.search=!1;k.resetsearch=!0;try{if("currentfilter"!==f.refreshstate){k.postData.filters="";try{a("#fbox_"+t).jqFilter("resetFilter")}catch(b){}a.isFunction(g.clearToolbar)&&g.clearToolbar(!1)}}catch(b){}switch(f.refreshstate){case "firstpage":r.trigger("reloadGrid",[a.extend({},f.reloadGridOptions||{},{page:1})]);break;case "current":case "currentfilter":r.trigger("reloadGrid",
[a.extend({},f.reloadGridOptions||{},{current:!0})])}a.isFunction(f.afterRefresh)&&f.afterRefresh.call(g)}return!1},Z=function(c,d,e){var g=a("<div class='"+C+"' tabindex='0' role='button'></div>"),h=f[c+"icon"],k=a.trim(f[c+"text"]);g.append("<div class='ui-pg-div'><span class='"+(f.iconsOverText?U("ui-pg-button-icon-over-text",A,h):U(A,h))+"'></span>"+(k?"<span class='ui-pg-button-text"+(f.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+k+"</span>":"")+"</div>");a(b).append(g);g.attr({title:f[c+
"title"]||"",id:d||c+"_"+L}).click(e).hover(aa,E);return g};f.cloneToTop&&k.toppager&&(x=2);for(F=0;F<x;F++){b=a("<div class='ui-pg-table navtable' role='toolbar' style='float:"+("rtl"===k.direction?"right":"left")+";table-layout:auto;'></div>");0===F?(u=n,L=z,u===k.toppager&&(L+="_top",x=1)):(u=k.toppager,L=z+"_top");f.add&&Z("add",m.id,X);f.edit&&Z("edit",e.id,fa);f.view&&Z("view",c.id,Y);f.del&&Z("del",l.id,ca);(f.add||f.edit||f.del||f.view)&&a(b).append(h);f.search&&(p=Z("search",d.id,T),d.showOnLoad&&
!0===d.showOnLoad&&a(p,b).click());f.refresh&&Z("refresh","",da);p=a(".ui-jqgrid>.ui-jqgrid-view").css("font-size")||"11px";a("body").append("<div id='testpg2' class='"+K.call(g,"gBox","ui-jqgrid")+"' style='font-size:"+p+";visibility:hidden;' ></div>");p=a(b).clone().appendTo("#testpg2").width();a("#testpg2").remove();a(u+"_"+f.position,u).append(b);if(f.hideEmptyPagerParts)for(O=0;O<V.length;O++)V[O]!==f.position&&(Q=a(u+"_"+V[O],u),0===Q.length||0===Q[0].childNodes.length?Q.hide():1===Q[0].childNodes.length&&
(N=Q[0].firstChild,!a(N).is("table.ui-pg-table")||0!==N.rows&&0!==N.rows[0].cells.length||Q.hide()));k._nvtd&&(p>k._nvtd[0]&&(a(u+"_"+f.position,u).width(p),k._nvtd[0]=p),k._nvtd[1]=p);g.nav=!0;b.bind("keydown.jqGrid",y)}r.triggerHandler("jqGridResetFrozenHeights")}}})},navButtonAdd:function(n,R){"object"===typeof n&&(R=n,n=void 0);return this.each(function(){var e=this,m=e.p;if(e.grid){var l=a.extend({caption:"newButton",title:"",onClickButton:null,position:"last",cursor:"pointer",iconsOverText:!1},
B.getGridRes.call(a(e),"nav"),v.nav||{},m.navOptions||{},R||{}),d=P.call(e,"hover"),c=P.call(e,"disabled"),g=K.call(e,"navButton","ui-pg-button");if(void 0===n)if(m.pager)if(B.navButtonAdd.call(a(e),m.pager,l),m.toppager)n=m.toppager;else return;else m.toppager&&(n=m.toppager);"string"===typeof n&&0!==n.indexOf("#")&&(n="#"+D(n));var m=a(".navtable",n),k=l.commonIconClass;if(0<m.length&&!(l.id&&0<m.find("#"+D(l.id)).length)){var r=a("<div tabindex='0' role='button'></div>");"NONE"===l.buttonicon.toString().toUpperCase()?
a(r).addClass(g).append("<div class='ui-pg-div'>"+(l.caption?"<span class='ui-pg-button-text"+(l.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+l.caption+"</span>":"")+"</div>"):a(r).addClass(g).append("<div class='ui-pg-div'><span class='"+(l.iconsOverText?U("ui-pg-button-icon-over-text",k,l.buttonicon):U(k,l.buttonicon))+"'></span>"+(l.caption?"<span class='ui-pg-button-text"+(l.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+l.caption+"</span>":"")+"</div>");l.id&&a(r).attr("id",l.id);
"first"===l.position&&0<m.children("div.ui-pg-button").length?m.children("div.ui-pg-button").first().before(r):m.append(r);a(r,m).attr("title",l.title||"").click(function(d){S(this,c)||a.isFunction(l.onClickButton)&&l.onClickButton.call(e,l,d);return!1}).hover(function(){S(this,c)||a(this).addClass(d)},function(){a(this).removeClass(d)});a(e).triggerHandler("jqGridResetFrozenHeights")}}})},navSeparatorAdd:function(n,v){v=a.extend({sepclass:"ui-separator",sepcontent:"",position:"last"},v||{});return this.each(function(){if(this.grid){var e=
this.p,m=K.call(this,"navButton","ui-pg-button "+P.call(this,"disabled"));if(void 0===n)if(e.pager)if(B.navSeparatorAdd.call(a(this),e.pager,v),e.toppager)n=e.toppager;else return;else e.toppager&&(n=e.toppager);"string"===typeof n&&0!==n.indexOf("#")&&(n="#"+D(n));e=a(".navtable",n);0<e.length&&(m="<div class='"+m+"'><span class='"+v.sepclass+"'></span>"+v.sepcontent+"</div>","first"===v.position?0===e.children("div.ui-pg-button").length?e.append(m):e.children("div.ui-pg-button").first().before(m):
e.append(m))}})},GridToForm:function(n,v){return this.each(function(){var e,m,l,d;if(this.grid){var c=B.getRowData.call(a(this),n);if(c)for(e in c)if(c.hasOwnProperty(e))if(m=a("[name="+D(e)+"]",v),m.is("input:radio")||m.is("input:checkbox"))for(l=0;l<m.length;l++)d=a(m[l]),d.prop("checked",d.val()===String(c[e]));else m.val(da(c[e])?"":c[e])}})},FormToGrid:function(n,v,e,m){return this.each(function(){if(this.grid){e||(e="set");m||(m="first");var l=a(v).serializeArray(),d={};a.each(l,function(a,
e){d[e.name]=e.value});"add"===e?B.addRowData.call(a(this),n,d,m):"set"===e&&B.setRowData.call(a(this),n,d)}})}})});
//# sourceMappingURL=grid.formedit.map
