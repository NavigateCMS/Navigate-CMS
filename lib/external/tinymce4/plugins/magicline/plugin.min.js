tinymce.PluginManager.requireLangPack("magicline","es,fr_FR");tinymce.PluginManager.add("magicline",function(b,a){if(typeof b.settings.valid_classes=="string"){b.settings.valid_classes+=" nomagicline"}else{if(typeof b.settings.valid_classes=="object"){var c=b.settings.valid_classes["*"];b.settings.valid_classes["*"]=(c!=undefined)?c+" nomagicline":"nomagicline"}}b.on("init",function(){var B=b.settings.magicline_color||"#4A8DE0",n=b.settings.magicline_targetedItems||["DIV","IMG"],u=b.settings.magicline_triggerMargin||20,l=b.settings.magicline_insertedBlockTag||"p";var g,H,j,s,p,i,e,v,x,h,f,r,m,w,F,D,q,o,A,t,k=tinymce.dom.DomQuery,E=b.dom,d=b.$()[0],z=(b.settings.inline===true);function y(J,I){i=parseInt(E.getStyle(J,"border-left-width",true));e=parseInt(E.getStyle(J,"border-right-width",true));s=parseInt(E.getStyle(J,"padding-left",true));p=parseInt(E.getStyle(J,"padding-right",true));o=I-u;q=E.getPos(J,d).x;A=E.getSize(J).w;q+=s;A-=s+p;if(D){o-=t}if(J===d){A-=i+e}else{q+=i;A-=i+e;if(D){q-=parseInt(E.getStyle(d,"border-left-width",true))}}}function G(I){H=k(I.target);if(H.hasClass("magicline-container")||H.parent(".magicline-container").length>0){return}m=false;while(H.length>0){if(H[0]==d){break}if(!H.hasClass("nomagicline")&&n.indexOf(H[0].tagName)>-1){m=true;j=H;break}H=H.parent()}if(m){D=(E.getStyle(d,"box-sizing",true)==="border-box");t=parseInt(E.getStyle(d,"border-top-width",true));h=E.getPos(H[0],d);f=E.getSize(H[0]);r=I.pageY;if(z){r-=E.getPos(d).y}if(!D){r-=t}if(Math.abs(h.y-r)<=u){v=H.prev();if(v.length==0||v.hasClass("magicline-container")||n.indexOf(v[0].tagName)>-1){w="top";y(H.parent()[0],h.y);if(E.getParents(g).length<=1){C()}E.setStyles(g,{top:o+"px",left:q+"px",width:A+"px"});E.show(g)}return}else{if(Math.abs(h.y+f.h-r)<=u){x=H.next();if(x.length==0||x.hasClass("magicline-container")||n.indexOf(x[0].tagName)>-1){w="bottom";y(H.parent()[0],h.y+f.h);if(E.getParents(g).length<=1){C()}E.setStyles(g,{top:o+"px",left:q+"px",width:A+"px"});E.show(g)}return}}}E.hide(g)}E.setStyle(d,"position","relative");function C(){if(g){E.remove(g)}g=E.create("div",{"class":"magicline-container",style:"width: 100%; position: absolute; display: block; top: 0; left: 0; margin: 0; padding: 0; height: "+u*2+"px;-webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;",contentEditable:"false","data-mce-bogus":"1"});E.add(g,"div",{"class":"magicline-dashedline",style:"position:absolute; top: 50%; left: 0; display: block; border: 0; border-top: 1px dashed "+B+"; height: 0; width: 100%; margin: 0; padding: 0;","data-mce-bogus":"1"});var I=E.add(g,"div",{"class":"magicline-bt_insert",style:'position: absolute; top: 50%; right: 25px; height: 16px; width: 16px; margin: 0; padding: 0; margin-top: -7px;font-size: 0;color: white; background: url("'+a+'/img/icon.png") center no-repeat '+B+";cursor: pointer; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;",title:tinymce.util.I18n.translate("Insert paragraph here"),contentEditable:"false","data-mce-bogus":"1"});E.add(g,"div",{"class":"magicline-arrow-left",style:"display: block; position: absolute; left: 0; top: 50%; height: 0; width: 0; margin: 0; padding: 0; margin-top: -7px;border: 8px solid transparent; border-left-color: "+B+";",contentEditable:"false","data-mce-bogus":"1"});E.add(g,"div",{"class":"magicline-arrow-right",style:"display: block; position: absolute; right: 0; top: 50%; height: 0; width: 0; margin: 0; padding: 0; margin-top: -7px;border: 8px solid transparent; border-right-color: "+B+";",contentEditable:"false","data-mce-bogus":"1"});E.bind(g,"click",function(J){if(J.target===I){b.focus(false);var K=E.create(l,{},'<br data-mce-bogus="1">');if(w==="top"){j.before(K)}else{j.after(K)}b.selection.select(K,true)}E.hide(g)});E.hide(g);E.add(d,g)}C();b.$().on("mousemove",function(I){clearTimeout(F);F=setTimeout(function(){G(I)},25)})})});